<div class="qna-wrapper container mt-4">
  <h3 class="page-title text-primary fw-bold">💬 QnA Management</h3>

  <!-- PrimeNG Table -->
  <p-table
    *ngIf="qna.length > 0"
    [value]="qna"
    [paginator]="true"
    [rows]="5"
    [rowsPerPageOptions]="[5, 10, 20]"
    [responsiveLayout]="'scroll'"
    class="custom-qna-table shadow-sm mt-3"
  >
    <ng-template pTemplate="header">
      <tr>
        <th>#</th>
        <th>Question</th>
        <th>Asked By</th>
        <th>Batch</th>
        <th>Answer</th>
        <th>Actions</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-item let-i="rowIndex">
      <tr>
        <td>{{ i + 1 }}</td>
        <td class="fw-semibold">{{ item.text }}</td>
        <td>{{ item.userName }}</td>
        <td>{{ item.batchName || '—' }}</td>
        <td>
          <!-- Edit mode -->
          <div *ngIf="editAnswerId === item.id; else viewAnswer">
            <input type="text" class="form-control mb-2" [(ngModel)]="editAnswerText" />
            <button class="btn btn-update btn-sm me-2" (click)="updateAnswer(item.id)">💾 Save</button>
            <button class="btn btn-cancel btn-sm" (click)="cancelEditAnswer()">❌ Cancel</button>
          </div>

          <!-- Normal view -->
          <ng-template #viewAnswer>
            <div *ngIf="item.answer; else noAnswer">
              <span class="answer-text">{{ item.answer }}</span>
              <button class="btn btn-link btn-sm p-0 ms-2 edit-link" (click)="startEditAnswer(item)">
                ✏️ Edit 
              </button>
            </div>
            <ng-template #noAnswer>
              <input type="text" class="form-control mb-2" placeholder="Enter answer" #answerInput />
              <button class="btn btn-submit btn-sm" (click)="answerQuestion(item.id, answerInput.value)">
                ✅ Submit
              </button>
            </ng-template>
          </ng-template>
        </td>
        <td>
          <button class="btn btn-delete btn-sm" (click)="deleteQuestion(item.id)">🗑️ </button>
        </td>
      </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="5" class="text-center text-muted">❌ No questions found.</td>
      </tr>
    </ng-template>
  </p-table>
</div>
